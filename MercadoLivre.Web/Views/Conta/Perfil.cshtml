@model Usuario

@{
    ViewData["Title"] = "Meu Perfil";
}

<div class="container my-4">
    
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Início</a></li>
            <li class="breadcrumb-item active">Meu Perfil</li>
        </ol>
    </nav>

    <div class="row">
        
        <div class="col-lg-3">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="fas fa-user-circle fa-lg me-2"></i>
                        @Model.Nome
                    </h6>
                </div>
                <div class="list-group list-group-flush">
                    <a href="#" class="list-group-item list-group-item-action active">
                        <i class="fas fa-user me-2"></i> Dados pessoais
                    </a>
                    <a asp-action="MeusPedidos" class="list-group-item list-group-item-action">
                        <i class="fas fa-shopping-bag me-2"></i> Meus pedidos
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-heart me-2"></i> Lista de desejos
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-map-marker-alt me-2"></i> Endereços
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-credit-card me-2"></i> Cartões
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-bell me-2"></i> Notificações
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-shield-alt me-2"></i> Privacidade
                    </a>
                    <a asp-action="Logout" class="list-group-item list-group-item-action text-danger">
                        <i class="fas fa-sign-out-alt me-2"></i> Sair
                    </a>
                </div>
            </div>

            
            <div class="card mt-3">
                <div class="card-body text-center">
                    <i class="fas fa-wallet fa-2x text-success mb-2"></i>
                    <h6>Seu saldo</h6>
                    <div class="display-6 text-success fw-bold">R$ @Model.Saldo.ToString("N2")</div>
                    <button class="btn btn-outline-success btn-sm mt-2">
                        <i class="fas fa-plus"></i> Adicionar saldo
                    </button>
                </div>
            </div>
        </div>

        
        <div class="col-lg-9">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-user"></i> Dados pessoais</h5>
                </div>
                <div class="card-body">
                    <form asp-action="Perfil" method="post">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label asp-for="Nome" class="form-label">Nome completo:</label>
                                    <input asp-for="Nome" class="form-control" required>
                                    <span asp-validation-for="Nome" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="Telefone" class="form-label">Telefone:</label>
                                    <input asp-for="Telefone" class="form-control" placeholder="(11) 99999-9999">
                                    <span asp-validation-for="Telefone" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Email" class="form-label">E-mail:</label>
                            <input asp-for="Email" type="email" class="form-control" readonly>
                            <small class="text-muted">O e-mail não pode ser alterado</small>
                        </div>

                        <hr class="my-4">

                        <h6 class="mb-3"><i class="fas fa-map-marker-alt"></i> Endereço</h6>

                        <div class="row">
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label asp-for="CEP" class="form-label">CEP:</label>
                                    <input asp-for="CEP" class="form-control" placeholder="00000-000" maxlength="9">
                                    <span asp-validation-for="CEP" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-9">
                                <div class="mb-3">
                                    <label asp-for="Endereco" class="form-label">Endereço completo:</label>
                                    <input asp-for="Endereco" class="form-control" placeholder="Rua, número, complemento">
                                    <span asp-validation-for="Endereco" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label asp-for="Cidade" class="form-label">Cidade:</label>
                                    <input asp-for="Cidade" class="form-control" placeholder="Sua cidade">
                                    <span asp-validation-for="Cidade" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="Estado" class="form-label">Estado:</label>
                                    <select asp-for="Estado" class="form-select">
                                        <option value="">Selecione</option>
                                        <option value="AC">Acre</option>
                                        <option value="AL">Alagoas</option>
                                        <option value="AP">Amapá</option>
                                        <option value="AM">Amazonas</option>
                                        <option value="BA">Bahia</option>
                                        <option value="CE">Ceará</option>
                                        <option value="DF">Distrito Federal</option>
                                        <option value="ES">Espírito Santo</option>
                                        <option value="GO">Goiás</option>
                                        <option value="MA">Maranhão</option>
                                        <option value="MT">Mato Grosso</option>
                                        <option value="MS">Mato Grosso do Sul</option>
                                        <option value="MG">Minas Gerais</option>
                                        <option value="PA">Pará</option>
                                        <option value="PB">Paraíba</option>
                                        <option value="PR">Paraná</option>
                                        <option value="PE">Pernambuco</option>
                                        <option value="PI">Piauí</option>
                                        <option value="RJ">Rio de Janeiro</option>
                                        <option value="RN">Rio Grande do Norte</option>
                                        <option value="RS">Rio Grande do Sul</option>
                                        <option value="RO">Rondônia</option>
                                        <option value="RR">Roraima</option>
                                        <option value="SC">Santa Catarina</option>
                                        <option value="SP">São Paulo</option>
                                        <option value="SE">Sergipe</option>
                                        <option value="TO">Tocantins</option>
                                    </select>
                                    <span asp-validation-for="Estado" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <h6 class="mb-3"><i class="fas fa-chart-line"></i> Estatísticas da conta</h6>

                        <div class="row">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-shopping-cart fa-2x mb-2"></i>
                                        <h4>12</h4>
                                        <small>Compras realizadas</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-success text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-star fa-2x mb-2"></i>
                                        <h4>4.8</h4>
                                        <small>Sua avaliação média</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-warning text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-heart fa-2x mb-2"></i>
                                        <h4>8</h4>
                                        <small>Favoritos salvos</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-info text-white">
                                    <div class="card-body text-center">
                                        <i class="fas fa-calendar fa-2x mb-2"></i>
                                        <h4>2023</h4>
                                        <small>Membro desde</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                            <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left"></i> Voltar
                            </a>
                            <div>
                                <button type="button" class="btn btn-outline-danger me-2" onclick="confirmarExclusao()">
                                    <i class="fas fa-trash"></i> Excluir conta
                                </button>
                                <button type="submit" class="btn btn-ml-primary">
                                    <i class="fas fa-save"></i> Salvar alterações
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-shield-alt"></i> Segurança</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Alterar senha</h6>
                            <p class="text-muted small">Mantenha sua conta segura com uma senha forte</p>
                            <button class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-key"></i> Alterar senha
                            </button>
                        </div>
                        <div class="col-md-6">
                            <h6>Autenticação em duas etapas</h6>
                            <p class="text-muted small">Adicione uma camada extra de segurança</p>
                            <button class="btn btn-outline-success btn-sm">
                                <i class="fas fa-mobile-alt"></i> Configurar 2FA
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Máscara para telefone
            $('input[name="Telefone"]').on('input', function() {
                let value = $(this).val().replace(/\D/g, '');
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                $(this).val(value);
            });

            // Máscara para CEP
            $('input[name="CEP"]').on('input', function() {
                let value = $(this).val().replace(/\D/g, '');
                value = value.replace(/^(\d{5})(\d)/, '$1-$2');
                $(this).val(value);
            });

            // Buscar CEP
            $('input[name="CEP"]').on('blur', function() {
                const cep = $(this).val().replace(/\D/g, '');
                
                if (cep.length === 8) {
                    $.get(`https://viacep.com.br/ws/${cep}/json/`)
                        .done(function(data) {
                            if (!data.erro) {
                                $('input[name="Endereco"]').val(data.logradouro);
                                $('input[name="Cidade"]').val(data.localidade);
                                $('select[name="Estado"]').val(data.uf);
                            }
                        })
                        .fail(function() {
                            console.log('Erro ao buscar CEP');
                        });
                }
            });
        });

        function confirmarExclusao() {
            if (confirm('Tem certeza que deseja excluir sua conta? Esta ação não pode ser desfeita.')) {
                if (confirm('Esta é sua última chance! Confirma a exclusão da conta?')) {
                    // Aqui seria feita a chamada para excluir a conta
                    alert('Funcionalidade de exclusão não implementada nesta demonstração.');
                }
            }
        }
    </script>
}
